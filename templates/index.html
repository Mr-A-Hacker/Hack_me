<script>
async function gatherClientData() {
  return {
    screen: { width: screen.width, height: screen.height, colorDepth: screen.colorDepth },
    tz: Intl.DateTimeFormat().resolvedOptions().timeZone,
    lang: navigator.language,
    cookiesEnabled: navigator.cookieEnabled,
    platform: navigator.platform,
    cores: navigator.hardwareConcurrency,
    memory: navigator.deviceMemory || "Unknown",
    touchPoints: navigator.maxTouchPoints,
    localTime: new Date().toString(),
    pluginsCount: navigator.plugins.length,
    connection: navigator.connection ? navigator.connection.effectiveType : "Unavailable"
  };
}

async function autoCollect() {
  const payload = await gatherClientData();
  const res = await fetch('/collect', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(payload)
  });
  const data = await res.json();
  document.getElementById('out').textContent = JSON.stringify(data.received, null, 2);
}

window.onload = autoCollect;
</script>
