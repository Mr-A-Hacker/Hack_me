<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Phishing Demo</title>
  <style>
    body { background:#0b0b12; color:#f50ac0; font-family:monospace; }
    .panel { border:1px solid #f50ac0; padding:16px; border-radius:12px; box-shadow:0 0 12px #f50ac0; }
  </style>
</head>
<body>
  <div class="panel">
    <h2>Phishing Demo</h2>
    <p>This page demonstrates what metadata a phishing site could collect automatically.</p>
    <pre id="out"></pre>
  </div>

<script>
async function gatherClientData() {
  // GPU info via WebGL
  let gpu = "Unavailable";
  try {
    const canvas = document.createElement("canvas");
    const gl = canvas.getContext("webgl") || canvas.getContext("experimental-webgl");
    const debugInfo = gl.getExtension("WEBGL_debug_renderer_info");
    gpu = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);
  } catch (e) {}

  // Battery info
  let batteryInfo = {};
  try {
    const battery = await navigator.getBattery();
    batteryInfo = {
      charging: battery.charging,
      level: battery.level,
      chargingTime: battery.chargingTime,
      dischargingTime: battery.dischargingTime
    };
  } catch (e) {
    batteryInfo = { status: "Unavailable" };
  }

  // Media devices
  let devicesCount = 0;
  try {
    const devices = await navigator.mediaDevices.enumerateDevices();
    devicesCount = devices.length;
  } catch (e) {}

  return {
    screen: { width: screen.width, height: screen.height, colorDepth: screen.colorDepth },
    tz: Intl.DateTimeFormat().resolvedOptions().timeZone,
    tzOffset: new Date().getTimezoneOffset(),
    lang: navigator.language,
    cookiesEnabled: navigator.cookieEnabled,
    cookiesSize: document.cookie.length,
    platform: navigator.platform,
    cores: navigator.hardwareConcurrency,
    memory: navigator.deviceMemory || "Unknown",
    touchPoints: navigator.maxTouchPoints,
    localTime: new Date().toString(),
    pluginsCount: navigator.plugins.length,
    vendor: navigator.vendor,
    gpu: gpu,
    battery: batteryInfo,
    devicesCount: devicesCount,
    prefersDark: window.matchMedia('(prefers-color-scheme: dark)').matches
  };
}

async function autoCollect() {
  const payload = await gatherClientData();
  const res = await fetch('/collect', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(payload)
  });
  const data = await res.json();
  document.getElementById('out').textContent = JSON.stringify(data.received, null, 2);
}

// Run automatically when the page loads
window.onload = autoCollect;
</script>
</body>
</html>
